function melangerTableau(e){for(let a=e.length-1;a>0;a--){const n=Math.floor(crypto.getRandomValues(new Uint32Array(1))[0]/4294967296*(a+1));[e[a],e[n]]=[e[n],e[a]]}return e}let filmsData=null;const COMBINAISONS_INTERDITES=[["Action","Romance"],["Horreur","Familial"],["Science-Fiction","Histoire"],["Guerre","Comédie"],["Drame","Fantastique"],["Mystère","Animation"]];function estGenreAutorise(e){return!COMBINAISONS_INTERDITES.some((a=>a.every((a=>e.genre.includes(a)))))}async function chargerFilms(){if(!filmsData)try{const e=await fetch(`search/p.json?nocache=${Date.now()}`);if(!e.ok)throw new Error(`Erreur HTTP : ${e.status}`);filmsData=await e.json()}catch(e){console.error("Erreur lors du chargement des données des films :",e),filmsData=[]}return filmsData}async function chargerFilmsAvecMelange(){return filmsData||(filmsData=await chargerFilms(),filmsData=melangerTableau(filmsData)),filmsData}async function chargerCategorie(e,a){try{const n=melangerTableau(await chargerFilms()).filter((a=>a.genre.includes(e)&&estGenreAutorise(a))).slice(0,16);document.querySelector(a).innerHTML=n.length?n.map((e=>`<div class="single-video">\n                    <a href="${e.emplacement}" title="${e.nom}">\n                        <div class="video-img">\n                            <span class="video-item-content">${e.nom}</span>\n                            <img src="${e.affiche}" alt="${e.nom}" loading="lazy">\n                        </div>\n                    </a>\n                </div>`)).join(""):"<p>Aucun film trouvé.</p>",reinitialiserOwlCarousel(a)}catch(n){console.error(`Erreur lors du chargement des films pour la catégorie "${e}" :`,n),document.querySelector(a).innerHTML="<p>Erreur de chargement.</p>"}}function reinitialiserOwlCarousel(e){const a=$(e);a.hasClass("owl-carousel")&&a.owlCarousel("destroy"),a.owlCarousel({loop:!1,margin:10,nav:!0,dots:!0,navText:["<i class='fas fa-angle-left'></i>","<i class='fas fa-angle-right'></i>"],responsive:{0:{items:2},600:{items:4},1e3:{items:7}}})}const CATEGORIES=[{name:"Action",container:".video-carousel-action"},{name:"Drame",container:".video-carousel-drame"},{name:"Horreur",container:".video-carousel-horreur"},{name:"Animation",container:".video-carousel-animation"},{name:"Crime",container:".video-carousel-policier"},{name:"Guerre",container:".video-carousel-guerre"},{name:"Comédie",container:".video-carousel-comedie"},{name:"Histoire",container:".video-carousel-histoire"},{name:"Romance",container:".video-carousel-romance"},{name:"Aventure",container:".video-carousel-aventure"},{name:"Fantastique",container:".video-carousel-fantastique"},{name:"Familial",container:".video-carousel-famille"},{name:"Mystère",container:".video-carousel-mystère"},{name:"Thriller",container:".video-carousel-thriller"},{name:"Science-Fiction",container:".video-carousel-science-fiction"}];async function chargerToutesLesCategories(){try{await Promise.all(CATEGORIES.map((({name:e,container:a})=>chargerCategorie(e,a)))),console.log("Toutes les catégories ont été chargées avec succès.")}catch(e){console.error("Erreur lors du chargement des catégories :",e)}}document.addEventListener("DOMContentLoaded",chargerToutesLesCategories);const videoCarousel=document.getElementById("videoCarousel");function reinitialiserOwlCarousel(e){const a=$(e);a.hasClass("owl-carousel")&&a.owlCarousel("destroy"),a.owlCarousel({nav:!0,margin:20,navText:['<i class="fas fa-angle-left"></i>','<i class="fas fa-angle-right"></i>'],responsive:{0:{items:2,slideBy:2,margin:15},480:{items:3,slideBy:3},768:{items:4,slideBy:4},991:{items:5,slideBy:5},1198:{items:7,slideBy:7}}})}fetch("search/films-en-tendance.json").then((e=>e.json())).then((e=>{e.forEach((e=>{const a=document.createElement("div");a.classList.add("single-video"),a.innerHTML=`\n                <a href="${e.link}" title="${e.title}">\n                    <div class="video-img">\n                        <span class="video-item-content">${e.title}</span>\n                        <img src="${e.img}" alt="${e.title}" title="${e.title}">\n                    </div>\n                </a>\n            `,videoCarousel.appendChild(a)})),reinitialiserOwlCarousel("#videoCarousel")})).catch((e=>console.error("Erreur lors du chargement des films :",e))),$(document).ready((function(){reinitialiserOwlCarousel("#videoCarousel")})),fetch("search/films-en-tendance.json").then((e=>e.json())).then((e=>{const a=document.querySelector(".view-all-video-area .row");e.forEach((e=>{const n=document.createElement("div");n.classList.add("col-lg-2","col-md-3","col-sm-4","col-xs-12","col-6"),n.innerHTML=`\n                <div class="single-video">\n                    <a href="${e.link}" title="${e.title}">\n                        <div class="video-img">\n                            <span class="video-item-content">${e.title}</span>\n                            <img src="${e.img}" alt="${e.title}" title="${e.title}">\n                        </div>\n                    </a>\n                </div>\n            `,a.appendChild(n)}))}));