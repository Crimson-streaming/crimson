async function showSuggestions(e){const n=document.getElementById("search_output");if(n.innerHTML="",e)try{const t=await fetch("../search/d.direct.json");if(!t.ok)throw new Error("Erreur réseau");const r=await t.json(),o=normalizeString(e),s=r.filter((e=>normalizeString(e.nom).includes(o))).slice(0,48);s.length>0?s.forEach((e=>{const t=document.createElement("div");t.classList.add("single-video"),t.innerHTML=`\n                    <a href="${e.emplacement}">\n                        <div class="video-img">\n                            <span class="video-item-content">${e.nom}</span>\n                            <img src="${e.affiche}" alt="${e.nom}">\n                        </div>\n                    </a>\n                `,n.appendChild(t)})):n.innerHTML="<p>Aucun résultat trouvé.</p>"}catch(e){n.innerHTML="<p>Une erreur est survenue lors du chargement des données.</p>",console.error("Erreur de recherche:",e)}}function normalizeString(e){return e.toLowerCase().normalize("NFD").replace(/[u0300-u036f]/g,"").replace(/['’]/g,"").replace(/-/g," ").trim()}function isInWebIntoApp(){var e=navigator.userAgent||navigator.vendor||window.opera;return/wv/.test(e)}document.addEventListener("DOMContentLoaded",(()=>{const e=window.innerWidth>=600,n=(new Plyr("#player",{controls:e?["play-large","rewind","play","fast-forward","progress","current-time","mute","volume","settings","captions","pip","airplay","fullscreen"]:["play-large","rewind","play","fast-forward","progress","current-time","settings","captions","pip","airplay","fullscreen"],settings:["captions","quality","speed"],playsinline:!0,keyboard:{focused:!0,global:!0},fullscreen:{enabled:!0,fallback:!0,iosNative:!0},storage:{enabled:!0,key:"player"},invertTime:!1,disableContextMenu:!0,ratio:"16:9",autoplay:!0,i18n:{restart:"Recommencer",rewind:"Revenir de {seektime}s",play:"Lecture",pause:"Pause",fastForward:"Avancer de {seektime}s",seek:"Rechercher",seekLabel:"{currentTime} de {duration}",played:"Lancé",buffered:"Mis en mémoire",currentTime:"Temps actuel",duration:"Durée",volume:"Volume",mute:"Silence",unmute:"Son activé",enableCaptions:"Activer les sous-titres",disableCaptions:"Désactiver les sous-titres",download:"Télécharger",enterFullscreen:"Plein écran",exitFullscreen:"Sortir du plein écran",frameTitle:"Lecteur pour {title}",captions:"Sous-titres",settings:"Réglages",pip:"Picture-In-Picture",menuBack:"Retour au menu précédent",speed:"Vitesse",normal:"Normal",quality:"Qualité",loop:"Boucle",start:"Début",end:"Fin",all:"Tous",reset:"Réinitialiser",disabled:"Désactivé",enabled:"Activé",advertisement:"Publicité"},volume:1,muted:!1}),document.querySelector(".plyr__progress"));n&&(n.addEventListener("mousedown",(e=>{e.stopPropagation(),e.preventDefault()})),n.addEventListener("touchstart",(e=>{e.stopPropagation(),e.preventDefault()})));const t=document.getElementById("player"),r=t.querySelector("source").src;if(Hls.isSupported()&&!/iPad|iPhone|iPod/.test(navigator.userAgent)){const e=new Hls;e.loadSource(r),e.attachMedia(t),t.addEventListener("ended",(()=>{e.loadSource(r),t.play()})),e.on(Hls.Events.ERROR,((n,o)=>{if(o.fatal)switch(o.type){case Hls.ErrorTypes.NETWORK_ERROR:console.log("Erreur réseau, tentative de récupération..."),e.startLoad();break;case Hls.ErrorTypes.MEDIA_ERROR:console.log("Erreur média, tentative de récupération..."),e.recoverMediaError();break;default:console.log("Erreur fatale, rechargement..."),e.destroy(),e.loadSource(r),e.attachMedia(t)}}))}else t.canPlayType("application/vnd.apple.mpegurl")?(t.src=r,t.addEventListener("ended",(()=>{t.play()}))):console.error("Le flux HLS n'est pas supporté sur cet appareil.")})),isInWebIntoApp()&&setTimeout((function(){window.location.href="https://crimson-streaming.github.io/crimson/pages/déinstallation.html"}),2e3),isInWebIntoApp()&&(window.location.href="intent://crimson-streaming.github.io/crimson/pages/déinstallation.html#Intent;scheme=https;package=com.android.chrome;end"),document.addEventListener("DOMContentLoaded",(function(){if(window.self!==window.top){const e=document.createElement("div");e.style.position="fixed",e.style.top="-30px",e.style.left="0",e.style.width="100vw",e.style.height="100vh",e.style.backgroundColor="#0d0620",e.style.display="flex",e.style.flexDirection="column",e.style.justifyContent="center",e.style.alignItems="center",e.style.zIndex="9999",e.style.textAlign="center",e.style.color="#333";const n=document.createElement("style");n.innerHTML="\n            @keyframes pulse {\n                0% {\n                    transform: scale(1);\n                }\n                50% {\n                    transform: scale(1.1);\n                }\n                100% {\n                    transform: scale(1);\n                }\n            }\n            .pulse-animation {\n                animation: pulse 1s infinite;\n            }\n        ",document.head.appendChild(n),e.innerHTML='\n            <img src="https://crimson-streaming.github.io/crimson/img/logo.png" alt="Logo Crimson" style="width: 200px; margin-bottom: 50px;">\n            <h1 style="font-size: 24px;color: #fff;"><b>Vous naviguez sur une copie de Crimson ⚠️</b></h1>\n            <p style="font-size: 18px; margin: 20px 0; color: #fff;">\n                Crimson est uniquement disponible sur ce site \n            </p>\n            <a href="https://crimson-streaming.github.io/crimson/" target="_blank" class="pulse-animation" style="background-color: #b81b0e; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; font-size: 16px; text-decoration: none; margin: 5px; display: inline-block;">\n                Accéder au site Crimson\n            </a>\n\n        ',document.body.appendChild(e)}})),fetch("search/direct.json").then((e=>e.json())).then((e=>{let n=document.querySelector(".dtl-list-link li a");if(!n)return;let t=n.textContent.trim(),r=e.filter((e=>e.genre===t)),o=document.querySelector("#suggestions-carousel");o&&(r.forEach((e=>{let n=`\n            <div class="single-video">\n                <a href="${e.emplacement}" title="${e.nom}">\n                   <div class="video-img">\n                    <img src="${e.affiche}" title="${e.nom}" alt="${e.nom}" style="padding-top: 23px !important; padding-bottom: 12px !important;">\n                   </div>\n                 <span class="video-item-content">${e.nom}</span>\n               </a>\n            </div> `;o.insertAdjacentHTML("beforeend",n)})),"function"==typeof $.fn.owlCarousel?$("#suggestions-carousel").owlCarousel({loop:!1,margin:10,nav:!0,dots:!0,navText:["<i class='fas fa-angle-left'></i>","<i class='fas fa-angle-right'></i>"],responsive:{0:{items:2},600:{items:3},1e3:{items:5}}}):console.error("Owl Carousel n'est pas chargé correctement."))})).catch((e=>console.error("Erreur lors de la récupération des programmes:",e)));