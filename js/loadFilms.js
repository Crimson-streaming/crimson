const itemsPerPage=48;let currentPage=1,films=[];async function loadFilms(){try{const e=await fetch("search/f.json");films=await e.json(),renderFilms(currentPage),renderPagination()}catch(e){console.error("Erreur lors du chargement des films :",e)}}function renderFilms(e){const n=(e-1)*itemsPerPage,i=n+itemsPerPage,a=films.slice(n,i),r=document.getElementById("movies-container");r.innerHTML="",a.forEach((e=>{r.innerHTML+=`\n            <div class="col-lg-2 col-md-3 col-sm-4 col-xs-12 col-6">\n                <div class="single-video">\n                    <a href="${e.emplacement}" title="${e.nom}">\n                        <div class="video-img">\n                            <span class="video-item-content">${e.nom}</span>\n                            <img src="${e.affiche}" alt="${e.nom}" >\n                        </div>\n                    </a>\n                </div>\n            </div>\n        `}))}function renderPagination(){const e=Math.ceil(films.length/itemsPerPage),n=document.getElementById("pagination-links");n.innerHTML="";let i=Math.max(1,currentPage-Math.floor(5.5)),a=Math.min(e,i+11-1);a-i<10&&(i=Math.max(1,a-11+1)),n.innerHTML+=`\n        <li class="${1===currentPage?"disabled":""}">\n            <a class="prev page-numbers" href="#" onclick="changePage(${currentPage-1})"><i class="fa fa-caret-left"></i></a>\n        </li>\n    `;for(let e=i;e<=a;e++)n.innerHTML+=`\n            <li class="${e===currentPage?"active":""}">\n                <a class="page-numbers" href="#" onclick="changePage(${e})">${e}</a>\n            </li>\n        `;n.innerHTML+=`\n        <li class="${currentPage===e?"disabled":""}">\n            <a class="next page-numbers" href="#" onclick="changePage(${currentPage+1})"><i class="fa fa-caret-right"></i></a>\n        </li>\n    `}function changePage(e){const n=Math.ceil(films.length/itemsPerPage);e<1||e>n||(currentPage=e,renderFilms(currentPage),renderPagination())}let filteredFilms=[];async function loadFilms(){try{const e=await fetch("search/data.json");films=await e.json(),filteredFilms=films;const n=getURLParameter("genre");n?filterByGenre(n):(renderFilms(currentPage),renderPagination())}catch(e){console.error("Erreur lors du chargement des films :",e)}}function getURLParameter(e){return new URLSearchParams(window.location.search).get(e)}function renderFilms(e){const n=(e-1)*itemsPerPage,i=n+itemsPerPage,a=filteredFilms.slice(n,i),r=document.getElementById("movies-container");r.innerHTML="",a.forEach((e=>{r.innerHTML+=`\n            <div class="col-lg-2 col-md-3 col-sm-4 col-xs-12 col-6">\n                <div class="single-video">\n                    <a href="${e.emplacement}" title="${e.nom}">\n                        <div class="video-img">\n                            <span class="video-item-content">${e.nom}</span>\n                            <img src="${e.affiche}" alt="${e.nom}">\n                        </div>\n                    </a>\n                </div>\n            </div>\n        `}))}function renderPagination(){const e=Math.ceil(filteredFilms.length/itemsPerPage),n=document.getElementById("pagination-links");n.innerHTML="";let i=Math.max(1,currentPage-Math.floor(5.5)),a=Math.min(e,i+11-1);a-i<10&&(i=Math.max(1,a-11+1)),n.innerHTML+=`\n        <li class="${1===currentPage?"disabled":""}">\n            <a class="prev page-numbers" href="#" onclick="changePage(${currentPage-1})"><i class="fa fa-caret-left"></i></a>\n        </li>\n    `;for(let e=i;e<=a;e++)n.innerHTML+=`\n            <li class="${e===currentPage?"active":""}">\n                <a class="page-numbers" href="#" onclick="changePage(${e})">${e}</a>\n            </li>\n        `;n.innerHTML+=`\n        <li class="${currentPage===e?"disabled":""}">\n            <a class="next page-numbers" href="#" onclick="changePage(${currentPage+1})"><i class="fa fa-caret-right"></i></a>\n        </li>\n    `}function changePage(e){const n=Math.ceil(filteredFilms.length/itemsPerPage);e<1||e>n||(currentPage=e,renderFilms(currentPage),renderPagination())}function filterByGenre(e){if("all"===e)filteredFilms=films;else{const n=normalizeGenre(e);filteredFilms=films.filter((e=>e.genre.split(", ").map(normalizeGenre).includes(n)))}currentPage=1,renderFilms(currentPage),renderPagination()}function getQueryParam(e){return new URLSearchParams(window.location.search).get(e)}function setSelectedGenre(){const e=getQueryParam("genre");if(e){document.getElementById("genre-filter").value=e,filterByGenre(e)}}function applyFilter(){const e=document.getElementById("filter_list").value;filteredFilms="###"===e?[...films].sort(((e,n)=>e.nom.localeCompare(n.nom))):"##"===e?[...films].sort((()=>Math.random()-.5)):[...films],renderFilms(currentPage),renderPagination()}function normalizeGenre(e){return{"Science Fiction":"Science-Fiction","Science-fiction":"Science-Fiction","Science-Fiction & Fantastique":"Science-Fiction",Fantastique:"Fantasy","Epouvante-horreur":"Horreur",Adventure:"Aventure",Comedy:"ComÃ©die",Familial:"Famille","Action & Adventure":"Action","War & Politics":"Guerre",Historique:"Histoire",Musical:"Musique",Crime:"Policier"}[e]||e}document.addEventListener("DOMContentLoaded",(()=>{setSelectedGenre(),loadFilms(),document.getElementById("filter_list").addEventListener("change",applyFilter)}));